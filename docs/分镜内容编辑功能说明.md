# 分镜内容编辑功能说明

**版本**：v1.3.0  
**日期**：2025-12-18  
**功能**：编辑分镜的动作描述和台词

---

## 🎯 功能概述

在每个分镜中，您现在可以：
- ✅ **编辑动作描述** - 修改分镜的 `actionSummary`
- ✅ **编辑台词** - 修改或添加/删除分镜的 `dialogue`
- ✅ **实时更新** - 修改立即保存到项目

### 为什么需要这个功能？

**核心原因**：AI生成的动作描述和台词可能不够准确或不符合您的创意意图。

- **动作描述**：影响分镜的视觉呈现和画面提示词的生成
- **台词**：影响故事的叙事节奏和角色表达
- **手动编辑**：确保每个分镜都完美符合您的创作意图

---

## 📍 功能位置

**剧本清单页面** → **分镜列表** → **动作描述区域**

---

## 🎨 界面说明

### 默认状态（查看模式）
```
┌────────────────────────────────────────┐
│ SHOT 003                               │
├────────────────────────────────────────┤
│ Alex walking into the spaceship    ✏️ │ ← 鼠标悬停显示编辑按钮
│                                        │
│ "Welcome aboard."                      │ ← 台词（如果有）
└────────────────────────────────────────┘
```

### 编辑状态
```
┌────────────────────────────────────────┐
│ SHOT 003                               │
├────────────────────────────────────────┤
│ ┌────────────────────────────────────┐ │
│ │ 动作描述                           │ │
│ │ ┌────────────────────────────────┐ │ │
│ │ │ Alex walking confidently      │ │ │
│ │ │ into the spaceship command    │ │ │
│ │ │ center...                     │ │ │
│ │ └────────────────────────────────┘ │ │
│ │                                    │ │
│ │ 台词（可选）                       │ │
│ │ ┌────────────────────────────────┐ │ │
│ │ │ Welcome aboard, Captain.      │ │ │
│ │ └────────────────────────────────┘ │ │
│ │                                    │ │
│ │ [✓ 保存] [✗ 取消]                 │ │
│ └────────────────────────────────────┘ │
└────────────────────────────────────────┘
```

---

## 🚀 使用步骤

### 1. 进入编辑模式

1. 在剧本清单页面，找到需要编辑的分镜
2. 在动作描述区域，鼠标悬停
3. 点击右侧的 **✏️ 编辑图标**
4. 进入编辑模式

### 2. 编辑动作描述

在"动作描述"文本框中：
1. 修改现有的动作描述
2. 可以添加更多细节
3. 确保描述清晰、具体

**示例**：
- **原始**：`Alex walking into spaceship`
- **优化**：`Alex walking confidently into the spaceship command center, looking around in awe at the holographic displays`

### 3. 编辑台词（可选）

在"台词"文本框中：
1. 修改现有台词
2. 添加新台词（如果原本没有）
3. 删除台词（清空文本框）

**示例**：
- **原始**：`Welcome aboard.`
- **优化**：`Welcome aboard, Captain. The crew is ready for departure.`
- **删除**：留空文本框

### 4. 保存修改

点击 **✓ 保存** 按钮：
- 动作描述和台词立即更新
- 自动保存到项目
- 退出编辑模式

或点击 **✗ 取消** 放弃修改。

---

## 💡 使用场景

### 场景 1：动作描述不够详细

**问题**：AI生成的动作描述太简单  
**原始**：`Character walking`

**解决方案**：
1. 点击编辑
2. 修改为：`Character walking slowly through the rain-soaked street, shoulders hunched, looking dejected`
3. 保存

**效果**：更详细的描述帮助生成更准确的画面

---

### 场景 2：台词需要调整

**问题**：台词不符合角色性格  
**原始**：`Hello.`

**解决方案**：
1. 点击编辑
2. 修改为：`Well, well, well... look who finally decided to show up.`
3. 保存

**效果**：台词更符合角色性格和情节需要

---

### 场景 3：添加台词

**问题**：分镜应该有台词但AI没有生成  
**原始**：无台词

**解决方案**：
1. 点击编辑
2. 在台词框中输入：`I've been waiting for this moment my entire life.`
3. 保存

**效果**：分镜现在包含台词，增强叙事

---

### 场景 4：删除台词

**问题**：分镜不需要台词（纯动作镜头）  
**原始**：`Let's go.`

**解决方案**：
1. 点击编辑
2. 清空台词文本框
3. 保存

**效果**：分镜变成纯动作镜头，更有电影感

---

### 场景 5：修正AI错误

**问题**：AI理解错误，生成了不相关的描述  
**原始**：`Alex dancing in the park`（实际应该是在飞船上）

**解决方案**：
1. 点击编辑
2. 修改为：`Alex checking the navigation console on the spaceship bridge`
3. 保存

**效果**：动作描述与场景匹配

---

## 🎯 最佳实践

### 动作描述编写技巧

#### 1. 具体而生动
- ✅ `Alex walking confidently, chest out, making eye contact`
- ❌ `Alex walking`

#### 2. 包含情绪和细节
- ✅ `Sarah sitting alone at the cafe, nervously checking her phone every few seconds`
- ❌ `Sarah sitting`

#### 3. 描述镜头重点
- ✅ `Close-up of John's hands trembling as he opens the letter`
- ❌ `John opening letter`

#### 4. 考虑镜头运动
- ✅ `Camera follows Alex as he runs through the crowded market, dodging vendors`
- ❌ `Alex running`

---

### 台词编写技巧

#### 1. 符合角色性格
- **冷静角色**：`I see. Proceed with caution.`
- **热情角色**：`Oh my god! This is amazing! Let's do it!`

#### 2. 推动情节发展
- ✅ `The package will arrive at midnight. Don't be late.`
- ❌ `Hello.`

#### 3. 自然对话
- ✅ `You know what? I'm done. I'm out.`
- ❌ `I am terminating my participation in this endeavor.`

#### 4. 适当留白
- 有时无台词更有力量
- 纯动作或表情镜头可以删除台词

---

## 🔗 与其他功能的关联

### 1. 画面提示词生成

动作描述会影响AI生成的画面提示词：

```
动作描述: "Alex walking confidently into spaceship"
         ↓
画面提示词: "Medium shot of Alex walking confidently 
            into futuristic spaceship, determined 
            expression, cinematic lighting..."
```

**建议**：编辑动作描述后，检查并可能需要更新画面提示词

---

### 2. 导演工作台

动作描述和台词会在导演工作台显示，帮助您：
- 理解每个分镜的内容
- 生成更准确的关键帧
- 确保视频叙事连贯

---

### 3. 最终视频

台词会影响：
- 字幕生成（如果有）
- 配音脚本（如果需要）
- 整体叙事节奏

---

## ⚠️ 注意事项

### 1. 修改立即生效

- 所有修改立即保存到项目
- 无需手动"保存项目"
- 如果误操作，可以立即重新编辑恢复

### 2. 影响已生成的内容

- 如果已经生成了关键帧，修改动作描述后建议重新生成
- 台词修改不影响已生成的图像，但影响叙事理解

### 3. 动作描述与画面提示词的关系

- 动作描述是给人看的（中文，易读）
- 画面提示词是给AI看的（英文，技术性）
- 修改动作描述后，可能需要同步更新画面提示词

### 4. 台词长度建议

- 短镜头（<5秒）：0-10字
- 中等镜头（5-10秒）：10-30字
- 长镜头（>10秒）：30-50字
- 避免过长的台词（难以在镜头时长内说完）

---

## 🎬 实际案例

### 案例 1：科幻短片

**场景**：主角发现外星飞船

**原始分镜**：
```
动作：Character looking at object
台词：Wow.
```

**优化后**：
```
动作：Alex stops in his tracks, eyes widening in disbelief 
     as he stares at the massive alien spacecraft hovering 
     silently above the desert
台词：This... this changes everything.
```

**效果**：更有冲击力，更好地传达角色的震撼

---

### 案例 2：爱情故事

**场景**：分手场景

**原始分镜**：
```
动作：Two people talking
台词：Goodbye.
```

**优化后**：
```
动作：Sarah turns away, fighting back tears, while John 
     reaches out but stops himself, hand frozen in mid-air
台词：（无台词）
```

**效果**：通过动作和沉默传达情感，更有张力

---

### 案例 3：动作片

**场景**：追逐场景

**原始分镜**：
```
动作：Character running
台词：Stop!
```

**优化后**：
```
动作：Alex sprints through the narrow alley, leaping over 
     obstacles, camera tracking from side with handheld 
     movement, breathing heavily
台词：（无台词 - 纯动作镜头）
```

**效果**：更动感，更有电影感

---

## 🔧 技术细节

### 数据结构

```typescript
interface Shot {
  id: string;
  actionSummary: string;    // 动作描述（可编辑）
  dialogue?: string;         // 台词（可编辑，可选）
  // ... 其他字段
}
```

### 编辑逻辑

```typescript
// 保存修改
const updatedShots = project.shots.map(shot => {
  if (shot.id === editingShotActionId) {
    return {
      ...shot,
      actionSummary: editingShotActionText,
      dialogue: editingShotDialogueText.trim() || undefined
    };
  }
  return shot;
});
```

### 台词处理

- 如果台词文本框为空或只有空格，`dialogue` 字段设为 `undefined`
- 这样可以正确删除台词（而不是保存空字符串）

---

## 🐛 常见问题

### Q1: 修改动作描述后，画面提示词会自动更新吗？

**A**: 不会。动作描述和画面提示词是独立的。修改动作描述后，建议检查画面提示词是否需要同步更新。

### Q2: 可以添加多段台词吗？

**A**: 当前版本每个分镜只支持一段台词。如果需要多段对话，建议拆分成多个分镜。

### Q3: 台词支持哪些语言？

**A**: 支持任何语言。台词会按原样保存和显示。

### Q4: 删除台词后能恢复吗？

**A**: 可以。立即重新编辑，输入台词即可。但如果已经进行了其他操作，可能无法恢复原始内容。

### Q5: 动作描述有字数限制吗？

**A**: 没有硬性限制，但建议保持在 100-200 字符以内，确保简洁易读。

---

## 📊 功能对比

| 功能 | 之前 | 现在 |
|------|------|------|
| 编辑动作描述 | ❌ 不支持 | ✅ 支持 |
| 编辑台词 | ❌ 不支持 | ✅ 支持 |
| 添加台词 | ❌ 不支持 | ✅ 支持 |
| 删除台词 | ❌ 不支持 | ✅ 支持 |
| 实时保存 | - | ✅ 立即生效 |

---

## 🔮 未来改进

### 计划中的功能
- [ ] 台词翻译（多语言支持）
- [ ] 台词时长估算（根据字数估算说话时间）
- [ ] 台词语音合成预览
- [ ] 批量编辑多个分镜的描述
- [ ] AI辅助优化（一键增强描述）
- [ ] 动作描述模板库

---

## 🎁 完整的编辑功能套件

现在您拥有完整的分镜编辑工具：

1. ✅ **角色视觉描述编辑** - 控制角色外观
2. ✅ **分镜画面提示词编辑** - 控制镜头画面
3. ✅ **分镜角色列表编辑** - 控制传入的参考图
4. ✅ **分镜动作描述编辑** - 控制分镜内容（新功能）
5. ✅ **分镜台词编辑** - 控制对话内容（新功能）

这五个功能共同确保您对AI生成内容的完全控制！

---

## 📞 反馈与支持

如果您在使用过程中遇到问题或有改进建议，欢迎反馈！

---

**功能已完成并准备就绪！** 🎬✨

